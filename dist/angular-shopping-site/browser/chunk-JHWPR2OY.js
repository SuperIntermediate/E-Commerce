import{b as A,e as w,i as N,j as P,k,m as F}from"./chunk-MQBGRNKI.js";import{a as R}from"./chunk-YFYQOU26.js";import{Eb as v,Fa as x,Ja as h,Ra as y,Rb as U,Sa as M,T as b,Vb as O,Xa as d,Y as p,Ya as i,Z as u,Za as n,a as C,cb as E,ea as f,eb as g,gb as c,kb as o,lb as _,sa as l,sb as S}from"./chunk-HE5TQUO2.js";function V(s,t){if(s&1&&(i(0,"option",9),o(1),n()),s&2){let e=t.$implicit;d("value",e),l(),_(e)}}function $(s,t){if(s&1){let e=E();i(0,"tr")(1,"td"),o(2),n(),i(3,"td"),o(4),n(),i(5,"td")(6,"select",5),g("ngModelChange",function(a){let m=p(e).$implicit,T=c();return u(T.changeRole(m.email,a))}),h(7,V,2,2,"option",6),n()(),i(8,"td")(9,"button",7),g("click",function(){let a=p(e).$implicit,m=c();return u(m.saveRole(a.email))}),o(10,"Save Role"),n(),i(11,"button",8),g("click",function(){let a=p(e).$implicit,m=c();return u(m.delete(a.email))}),o(12,"Delete"),n()()()}if(s&2){let e=t.$implicit,r=c();l(2),_(e.email),l(2),_(e.name),l(2),d("name",S("role-",e.email))("ngModel",r.roleByEmail()[e.email]),l(),d("ngForOf",r.roles)}}function B(s,t){s&1&&(i(0,"p",4),o(1,"No users registered."),n())}var D=class s{auth=b(R);users=f(this.auth.getRegisteredUsers());roles=["customer","seller","admin"];roleByEmail=f({});currentAdminEmail=v(()=>this.auth.user()?.email??"");refresh(){this.users.set(this.auth.getRegisteredUsers())}changeRole(t,e){let r=C({},this.roleByEmail());r[t]=e,this.roleByEmail.set(r)}saveRole(t){let e=this.roleByEmail()[t];e&&(this.auth.updateUserRole(t,e),this.refresh())}delete(t){let r=this.currentAdminEmail()===t?"This will log you out.":"";confirm(`Delete user ${t}? ${r}`)&&(this.auth.deleteUser(t),this.refresh())}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["app-admin-users"]],decls:18,vars:2,consts:[[1,"admin-users"],[1,"toolbar"],[1,"users-table"],[4,"ngFor","ngForOf"],[1,"empty"],[3,"ngModelChange","ngModel","name"],[3,"value",4,"ngFor","ngForOf"],[1,"primary",3,"click"],[1,"danger",3,"click"],[3,"value"]],template:function(e,r){e&1&&(i(0,"section",0)(1,"header",1)(2,"h2"),o(3,"Users Management"),n()(),i(4,"table",2)(5,"thead")(6,"tr")(7,"th"),o(8,"Email"),n(),i(9,"th"),o(10,"Name"),n(),i(11,"th"),o(12,"Role"),n(),i(13,"th"),o(14,"Actions"),n()()(),i(15,"tbody"),h(16,$,13,6,"tr",3),n()(),y(17,B,2,0,"p",4),n()),e&2&&(l(16),d("ngForOf",r.users()),l(),M(r.users().length===0?17:-1))},dependencies:[O,U,F,P,k,N,A,w],styles:[".admin-users[_ngcontent-%COMP%]{padding:1rem}.toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:1px solid #eee;padding:.5rem .6rem;text-align:left}select[_ngcontent-%COMP%]{padding:.4rem .5rem;border:1px solid #ddd;border-radius:.4rem}button.primary[_ngcontent-%COMP%]{background:#315efb;color:#fff;border:none;padding:.4rem .75rem;border-radius:.4rem;cursor:pointer}button.danger[_ngcontent-%COMP%]{color:#b00020;border:1px solid #ffccd2;background:#ffe9ec;padding:.4rem .75rem;border-radius:.4rem}.empty[_ngcontent-%COMP%]{color:#666}"]})};export{D as AdminUsersComponent};
