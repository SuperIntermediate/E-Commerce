import{a as V}from"./chunk-RUAZL4YI.js";import{a as F}from"./chunk-BGPM6P37.js";import{a as q,b as L,c as k,d as T,e as B,f as x,h as R,l as A,m as D}from"./chunk-MQBGRNKI.js";import{a as N}from"./chunk-YFYQOU26.js";import{a as U}from"./chunk-YQELJHLD.js";import{a as I}from"./chunk-B7GYXW7L.js";import{c as v,e as E,f as W}from"./chunk-SV7RER2E.js";import{Fa as h,Ra as M,Sa as y,T as s,Vb as O,Xa as c,Ya as n,Za as o,eb as P,gb as S,kb as i,lb as w,pb as m,qb as p,rb as g,sa as l,ub as b}from"./chunk-HE5TQUO2.js";var J=()=>["/login"];function K(u,a){if(u&1&&(n(0,"p",11),i(1),o()),u&2){let r=S();l(),w(r.error)}}var j=class u{router=s(E);route=s(v);auth=s(N);products=s(F);cart=s(I);session=s(V);name="";email="";password="";error="";role="customer";constructor(){let r=this.route.snapshot.queryParamMap.get("email");r&&(this.email=r)}signup(){this.error="";try{this.auth.signup({name:this.name.trim(),email:this.email.trim(),password:this.password,role:this.role});let a=this.route.snapshot.queryParamMap;if(a.get("action")==="add_to_cart"){let C=a.get("pid"),_=a.get("qty"),z=C?Number(C):NaN,H=_?Number(_):1,f=this.products.getById(z);f&&this.cart.add(U(f,Math.max(1,H)))}let e=a.get("redirectUrl"),d="/account",t=this.auth.user()?.role;t==="admin"?d="/admin":t==="seller"&&(d="/seller");let G=this.session.getLastUrl();this.router.navigateByUrl(e||G||d)}catch(a){this.error=a?.message||"Signup failed"}}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=h({type:u,selectors:[["app-signup-page"]],decls:28,vars:9,consts:[[1,"auth-page"],[1,"toolbar"],[1,"link",3,"routerLink"],["novalidate","",1,"form"],[1,"role-switch"],["type","radio","name","role","value","customer",3,"ngModelChange","ngModel"],["type","radio","name","role","value","seller",3,"ngModelChange","ngModel"],["type","text","name","name","required","",3,"ngModelChange","ngModel"],["type","email","name","email","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],[1,"submit",3,"click","disabled"],[1,"error"]],template:function(r,e){r&1&&(n(0,"section",0)(1,"header",1)(2,"h1"),i(3,"Sign up"),o(),n(4,"a",2),i(5,"Already have an account? Login"),o()(),n(6,"form",3)(7,"div",4)(8,"span"),i(9,"Sign up as"),o(),n(10,"label")(11,"input",5),g("ngModelChange",function(t){return p(e.role,t)||(e.role=t),t}),o(),i(12," Customer "),o(),n(13,"label")(14,"input",6),g("ngModelChange",function(t){return p(e.role,t)||(e.role=t),t}),o(),i(15," Seller "),o()(),n(16,"label"),i(17," Name "),n(18,"input",7),g("ngModelChange",function(t){return p(e.name,t)||(e.name=t),t}),o()(),n(19,"label"),i(20," Email "),n(21,"input",8),g("ngModelChange",function(t){return p(e.email,t)||(e.email=t),t}),o()(),n(22,"label"),i(23," Password "),n(24,"input",9),g("ngModelChange",function(t){return p(e.password,t)||(e.password=t),t}),o()(),n(25,"button",10),P("click",function(){return e.signup()}),i(26,"Create account"),o(),M(27,K,2,1,"p",11),o()()),r&2&&(l(4),c("routerLink",b(8,J)),l(7),m("ngModel",e.role),l(3),m("ngModel",e.role),l(4),m("ngModel",e.name),l(3),m("ngModel",e.email),l(3),m("ngModel",e.password),l(),c("disabled",!e.name||!e.email||!e.password),l(2),y(e.error?27:-1))},dependencies:[O,D,x,q,R,L,k,A,B,T,W],styles:[".auth-page[_ngcontent-%COMP%]{padding:1rem}.auth-page[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;gap:.75rem;max-width:400px}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #ddd;border-radius:.5rem}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{padding:.5rem .75rem;background:#1976d2;color:#fff;border:none;border-radius:4px;cursor:pointer}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.6}.auth-page[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#d32f2f}"]})};export{j as SignupPageComponent};
