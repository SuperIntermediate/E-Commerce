import{a as P}from"./chunk-LXBKTAHS.js";import{$a as o,Eb as s,Fa as x,T as f,Ub as S,Va as p,Vb as _,Wa as u,ab as i,bb as E,gb as v,ib as g,kb as r,lb as d,sa as a,wb as y,xb as b,yb as C}from"./chunk-HE5TQUO2.js";var M=(m,n)=>n[0],O=(m,n)=>n.title;function I(m,n){if(m&1&&(o(0,"li",8)(1,"span",4),r(2),i(),o(3,"span",5),r(4),y(5,"currency"),i(),E(6,"span",9),i()),m&2){let e=n.$implicit,t=v();a(2),d(e[0]),a(2),d(C(5,4,e[1],"INR","symbol","1.0-0")),a(2),g("width",e[1]/(t.totalRevenue()||1)*100,"%")}}function D(m,n){if(m&1&&(o(0,"li",8)(1,"span",4),r(2),i(),o(3,"span",5),r(4),i(),E(5,"span",9),i()),m&2){let e,t=n.$implicit,l=v();a(2),d(t.title),a(2),d(t.quantity),a(),g("width",t.quantity/(((e=l.topProducts()[0])==null?null:e.quantity)||1)*100,"%")}}function A(m,n){if(m&1&&(o(0,"li",8)(1,"span",4),r(2),i(),o(3,"span",5),r(4),y(5,"currency"),i(),E(6,"span",9),i()),m&2){let e=n.$implicit,t=v();a(2),d(e[0]),a(2),d(C(5,4,e[1],"INR","symbol","1.0-0")),a(2),g("width",e[1]/(t.revenueByCategory().max||1)*100,"%")}}var h=class m{ordersSvc=f(P);orders=s(()=>this.ordersSvc.orders());nonCancelled=s(()=>this.orders().filter(n=>n.status!=="CANCELLED"));totalRevenue=s(()=>this.nonCancelled().reduce((n,e)=>n+e.total,0));statusCounts=s(()=>{let n={};for(let e of this.orders())n[e.status]=(n[e.status]??0)+1;return n});revenueByMonth=s(()=>{let n={};for(let e of this.nonCancelled()){let t=new Date(e.date),l=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;n[l]=(n[l]??0)+e.total}return Object.entries(n).sort(([e],[t])=>e.localeCompare(t))});topProducts=s(()=>{let n={};for(let e of this.nonCancelled())for(let t of e.items)n[t.productId]=n[t.productId]??{title:t.title,quantity:0},n[t.productId].quantity+=t.quantity;return Object.values(n).sort((e,t)=>t.quantity-e.quantity).slice(0,5)});revenueByCategory=s(()=>{let n={};for(let l of this.nonCancelled())for(let c of l.items)n[c.category]=(n[c.category]??0)+c.price*c.quantity;let e=Object.entries(n).sort((l,c)=>c[1]-l[1]),t=e.length?e[0][1]:0;return{entries:e,max:t}});static \u0275fac=function(e){return new(e||m)};static \u0275cmp=x({type:m,selectors:[["app-admin-analytics"]],decls:59,vars:9,consts:[[1,"admin-analytics"],[1,"toolbar"],[1,"kpis"],[1,"kpi"],[1,"label"],[1,"value"],[1,"chart"],[1,"bars"],[1,"bar"],[1,"fill"]],template:function(e,t){e&1&&(o(0,"section",0)(1,"header",1)(2,"h2"),r(3,"Analytics Dashboard"),i()(),o(4,"div",2)(5,"div",3)(6,"div",4),r(7,"Total Revenue"),i(),o(8,"div",5),r(9),y(10,"currency"),i()(),o(11,"div",3)(12,"div",4),r(13,"Orders"),i(),o(14,"div",5),r(15),i()(),o(16,"div",3)(17,"div",4),r(18,"Placed"),i(),o(19,"div",5),r(20),i()(),o(21,"div",3)(22,"div",4),r(23,"Processing"),i(),o(24,"div",5),r(25),i()(),o(26,"div",3)(27,"div",4),r(28,"Shipped"),i(),o(29,"div",5),r(30),i()(),o(31,"div",3)(32,"div",4),r(33,"Delivered"),i(),o(34,"div",5),r(35),i()(),o(36,"div",3)(37,"div",4),r(38,"Cancelled"),i(),o(39,"div",5),r(40),i()()(),o(41,"section",6)(42,"h3"),r(43,"Revenue by Month"),i(),o(44,"ul",7),p(45,I,7,9,"li",8,M),i()(),o(47,"section",6)(48,"h3"),r(49,"Top Products (Units Sold)"),i(),o(50,"ul",7),p(51,D,6,4,"li",8,O),i()(),o(53,"section",6)(54,"h3"),r(55,"Revenue by Category"),i(),o(56,"ul",7),p(57,A,7,9,"li",8,M),i()()()),e&2&&(a(9),d(b(10,7,t.totalRevenue())),a(6),d(t.orders().length),a(5),d(t.statusCounts().PLACED),a(5),d(t.statusCounts().PROCESSING),a(5),d(t.statusCounts().SHIPPED),a(5),d(t.statusCounts().DELIVERED),a(5),d(t.statusCounts().CANCELLED),a(5),u(t.revenueByMonth()),a(6),u(t.topProducts()),a(6),u(t.revenueByCategory().entries))},dependencies:[_,S],styles:[".admin-analytics[_ngcontent-%COMP%]{padding:1rem}.toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.kpis[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:.75rem}.kpi[_ngcontent-%COMP%]{background:#f7f9ff;border:1px solid #e2e8ff;border-radius:.5rem;padding:.5rem .75rem}.kpi[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.85rem;color:#556}.kpi[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600}.chart[_ngcontent-%COMP%]{margin-top:1rem}.bars[_ngcontent-%COMP%]{list-style:none;margin:.5rem 0 0;padding:0}.bar[_ngcontent-%COMP%]{display:grid;grid-template-columns:140px 80px 1fr;align-items:center;gap:.5rem;margin-bottom:.375rem}.bar[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#333}.bar[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#111}.bar[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{display:inline-block;height:.75rem;background:linear-gradient(90deg,#315efb,#8ab4ff);border-radius:.375rem}"]})};export{h as AdminAnalyticsComponent};
